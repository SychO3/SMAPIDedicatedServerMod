# 不活跃玩家踢出功能

## 功能介绍

这个功能可以自动检测并踢出长时间没有活动的玩家，帮助维护服务器的活跃性和资源管理。

## 功能特点

- **自动检测玩家活动**：监测玩家的按键、鼠标移动和位置传送等活动
- **可配置的超时时间**：可以设置不同的不活跃踢出时间
- **实时状态显示**：可以查看所有玩家的活动状态
- **灵活的控制**：可以随时启用或禁用功能

## 配置选项

在 `config.json` 文件中，新增了以下配置选项：

```json
{
  "EnableInactivePlayerKick": true,        // 是否启用不活跃玩家踢出功能
  "InactiveKickTimeMinutes": 30            // 不活跃踢出时间（分钟）
}
```

### 配置说明

- `EnableInactivePlayerKick`: 设置为 `true` 启用功能，`false` 禁用功能
- `InactiveKickTimeMinutes`: 设置玩家多少分钟没有活动后被踢出，默认30分钟

## 控制台命令

### kick_status
显示当前所有在线玩家的活动状态和剩余时间。

```
kick_status
```

### kick_enable
启用不活跃玩家踢出功能。

```
kick_enable
```

### kick_disable
禁用不活跃玩家踢出功能。

```
kick_disable
```

### kick_timeout
设置不活跃踢出的超时时间（分钟）。

```
kick_timeout 60    # 设置为60分钟
kick_timeout 15    # 设置为15分钟
```

## 活动检测机制

系统会监测以下玩家活动：

1. **按键操作**：任何键盘按键
2. **鼠标活动**：鼠标移动和点击
3. **位置传送**：玩家在不同地图间的移动

当玩家进行任何上述活动时，系统会重置该玩家的不活跃计时器。

## 工作流程

1. **玩家连接**：当玩家连接到服务器时，系统开始记录其活动时间
2. **活动监测**：持续监测玩家的各种活动
3. **超时检查**：基于真实时间每分钟检查一次所有玩家的活动状态
4. **踢出操作**：当玩家超过设定的不活跃时间后，自动踢出该玩家
5. **记录清理**：玩家断开连接或被踢出后，清理相关记录

## 日志记录

系统会在以下情况记录日志：

- 玩家连接和断开连接
- 玩家因不活跃被踢出
- 功能启用和禁用
- 配置更改

## 使用建议

1. **合理设置时间**：根据服务器类型和玩家习惯设置合适的超时时间
   - 休闲服务器：30-60分钟
   - 活跃服务器：15-30分钟
   
2. **定期检查状态**：使用 `kick_status` 命令查看玩家状态

## ⏰ 时间机制说明

系统使用**真实时间**（而非游戏时间）进行计时：
- 检查间隔：每1分钟真实时间检查一次玩家状态
- 超时计算：基于真实世界的时间计算不活跃时长
- 即使游戏暂停，真实时间仍会继续计算

3. **灵活调整**：可以根据实际情况随时调整超时时间或启用/禁用功能

## 注意事项

- 主机玩家（服务器所有者）不会被踢出
- 功能只在多人游戏模式下生效
- 系统会自动处理玩家正常断线的情况
- 被踢出的玩家可以重新连接服务器

## 故障排除

如果功能没有正常工作，请检查：

1. 配置文件中 `EnableInactivePlayerKick` 是否为 `true`
2. 服务器是否处于多人游戏模式
3. 查看控制台日志是否有错误信息
